<!DOCTYPE html>
<html>
  <head>
    <title>MoFood</title>
    <!-- Bootstrap -->
    {% assets "css_all" %}
        <link rel="stylesheet" href="{{ ASSET_URL }}" media="screen"></script>
    {% endassets %}
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <style type="text/css">
        .container-fluid {
            margin-top: 10px;
        }
        .nav {
            margin-top: 50px;
        }
        li a{
            margin: 10px;
            font-size: 16px;
        }
        .datepicker {
            margin-top: 6px;
        }
        .date-selection {
            margin: 10px;
        }

    </style>
  </head>
  <body>
    <div class="container-fluid">
    <div class="row-fluid">
        <h2 class="span10 offset2">{{ date.strftime('%A, %B %d, %Y') }} </h2>
    </div>

    <div class="row-fluid">
        <ul id="navlist" class="nav nav-list affix span2">
            <li><a href="#1">Breakfast</a></li>
            <li><a href="#2">Lunch</a></li>
            <li><a href="#3">Dinner</a></li>
        </ul>
        <div class="row-fluid date-selection">
            <div class="span8 offset2">
                <input type="text" class="datepicker" id="menu-date" value="{{ date.strftime('%m/%d/%Y') }}" data-date-format="mm/dd/yyyy"> <span class="add-on"><i class="icon-th"></i></span>
                <button class="btn btn-small" id="prev-date"> << Prev </button>
                <button class="btn btn-small" id="next-date"> Next >></button>
            </div>
        </div>
        <div id="content" class="span6 offset2">
        {% if not meals  %}
            Sorry bro, I can't find meals for this date
        {% endif %}
        {% for meal in meals %}
            <section id="{{loop.index}}">
                <h2>{{ meal.headline|safe }}</h2>
                {{ meal.text|safe }}
            </section>
            </br>
        {% endfor %}
        </div>
    </div>
    </div>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    {% assets "js_all" %}
        <script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/datejs/1.0/date.min.js"></script>
    <script type="text/javascript">
        $(function(){
            $('.datepicker').datepicker();
            $('.datepicker').on('changeDate', function(ev){
                changeDateHandler(ev);
            });
            $('#next-date').click(function(){
                moveDatePickerBy(1);
            });
            $('#prev-date').click(function(){
                moveDatePickerBy(-1);
            });
        });
        function goToSuffix(newUrlSuffix){
            window.location = '/' + newUrlSuffix;
        }
        function changeDateHandler(ev){
            var newUrlSuffix = ev.date.toString('yyyy-MM-dd');
            goToSuffix(newUrlSuffix);
        }
        function moveDatePickerBy(offset){
            var d = Date.parse($('.datepicker').val());
            var newDate = d.add(offset).days();
            newUrlSuffix = newDate.toString('yyyy-MM-dd');
            goToSuffix(newUrlSuffix);

        }
    </script>
  </body>
</html>
