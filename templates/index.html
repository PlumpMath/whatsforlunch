<!DOCTYPE html>
<html>
  <head>
    <title>MoFood</title>
    <!-- Bootstrap -->
    {% assets "css_all" %}
        <link rel="stylesheet" href="{{ ASSET_URL }}" media="screen"></script>
    {% endassets %}
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <style type="text/css">
        #navlist li a{
            margin: 10px;
            font-size: 16px;
        }
        .datepicker {
            margin-top: 6px;
        }
        .date-selection {
            margin: 10px;
        }
        #content {
            padding-top: 10px;
        }

    </style>
  </head>
  <body>
    <div class="container-fluid">
        <div class="navbar">
            <div class="navbar-inner">
                <a class="brand" href="#">What's for Lunch @ MoPub?</a>
            </div>
        </div>
        <div class="row-fluid">
            <h2 class="span10 offset2">{{ date.strftime('%A, %B %d, %Y') }} </h2>
        </div>
        <div class="row-fluid">
            <ul id="navlist" class="nav nav-list affix span2">
                <li><a href="#1">Breakfast</a></li>
                <li><a href="#2">Lunch</a></li>
                <li><a href="#3">Dinner</a></li>
            </ul>
            <div class="row-fluid">
                <div class="span8 offset2 date-selection">
                    <input type="text" class="datepicker" id="menu-date" value="{{ date.strftime('%m/%d/%Y') }}" data-date-format="mm/dd/yyyy"> <span class="add-on"><i class="icon-th"></i></span>
                    <button class="btn btn-small btn-info" id="prev-date"> << Prev </button>
                    <button class="btn btn-small btn-info" id="next-date"> Next >></button>
                    <a class="btn btn-small btn-inverse" href={{ url_for('index') }}> Today </a>
                </div>
                <div class="row-fluid">
                    <select class="span4 offset2"multiple id="allergens" placeholder="Filter by your dietary restrictions...">
                        <option value="(Vegetarian)">Vegetarian</option>
                        <option value="(Vegan)">Vegan</option>
                        <option value="(Gluten Safe)">Gluten Safe</option>
                        <option value="(Dairy Safe)">Dairy Safe</option>
                        <option value="(Nut Safe)">Nut Safe</option>
                        <option value="(Soy Safe)">Soy Safe</option>
                        <option value="(Egg Safe)">Egg Safe</option>
                    </select>
                    <div class="span3" >
                        <button class="btn btn-small" id="clear-filters"> Clear filters</button>
                    </div>
                </div>
            </div>
            
            <div id="content" class="span10 offset2 menu">
            {% if not meals  %}
                Sorry, I can't find any meals for this date. Either we had no meals or cater2me stopped sending information about them.
            {% endif %}
            {% for meal in meals %}
                <section id="{{loop.index}}">
                    <h2>{{ meal.headline|safe }}</h2>
                    <h4> Served at {{ meal.time }}</h4>
                    {{ meal.text|safe }}
                </section>
                </br>
            {% endfor %}
            </div>
        </div>
    </div>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    {% assets "js_all" %}
        <script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/datejs/1.0/date.min.js"></script>
    <script type="text/javascript">
        $(function(){
            $('.datepicker').datepicker();
            $('.datepicker').on('changeDate', function(ev){
                changeDateHandler(ev);
            });
            $('#next-date').click(function(){
                moveDatePickerBy(1);
            });
            $('#prev-date').click(function(){
                moveDatePickerBy(-1);
            });
        });
        function goToSuffix(newUrlSuffix){
            window.location = '/' + newUrlSuffix;
        }
        function changeDateHandler(ev){
            var newUrlSuffix = ev.date.toString('yyyy-MM-dd');
            goToSuffix(newUrlSuffix);
        }
        function moveDatePickerBy(offset){
            var d = Date.parse($('.datepicker').val());
            var newDate = d.add(offset).days();
            newUrlSuffix = newDate.toString('yyyy-MM-dd');
            goToSuffix(newUrlSuffix);
        }
    </script>
  </body>
</html>
